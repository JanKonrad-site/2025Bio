<!-- =========================================================
     4.1.7 PROJEKT: KalkulaÄka Å™Ã­zenÃ¡ menu (funkce â†’ cykly â†’ vÃ½jimky â†’ sys)
     ========================================================= -->
<section id="section4-1-8" class="container my-5">
  <h3 class="mb-3">4.1.7 KalkulaÄka krok-za-krokem: funkce â†’ cykly â†’ vÃ½jimky â†’ <code>sys</code></h3>
  <p class="lead">PostavÃ­me kalkulaÄku jako skuteÄnou mini-aplikaci: <b>hlavnÃ­ menu ve smyÄce</b> vyvolÃ¡ <b>funkci kalkulaÄky</b>, kterÃ¡ Å™eÅ¡Ã­ vstupy, vÃ½bÄ›r operace a zobrazenÃ­ vÃ½sledku. Program ukonÄÃ­me korektnÄ› pÅ™es <code>sys.exit()</code>.</p>

  <!-- Akordeon krokÅ¯ -->
  <div class="accordion" id="acc-calc-menu">

    <!-- Krok 1: ÄistÃ© funkce operacÃ­ (vracÃ­ ÄÃ­slo nebo text chyby) -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="c1h">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#c1" aria-expanded="true">
          1) Funkce operacÃ­: krÃ¡tkÃ© a jednoÃºÄelovÃ©
        </button>
      </h2>
      <div id="c1" class="accordion-collapse collapse show" data-bs-parent="#acc-calc-menu">
        <div class="accordion-body">
          <p>ZaÄneme ÄtyÅ™mi funkcemi. VracÃ­ <b>ÄÃ­slo</b> (nebo u dÄ›lenÃ­ text v pÅ™Ã­padÄ› nuly). Tiskneme aÅ¾ pozdÄ›ji.</p>
<pre><code class="language-python">def soucet(a, b):  return a + b
def rozdil(a, b):  return a - b
def soucin(a, b):  return a * b
def podil(a, b):
    if b == 0:
        return "DÄ›lit nulou nejde."
    return a / b</code></pre>
          <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalReturnVsPrint">return Ã— print â€“ proÄ vracet?</button>
            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#modalFstring">f-string za chvÃ­li v prezentaci vÃ½sledku</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Krok 2: naÄtenÃ­ ÄÃ­sel s try/except -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="c2h">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c2">
          2) NaÄtenÃ­ ÄÃ­sel: <code>try/except</code> a opakovÃ¡nÃ­ dotazu
        </button>
      </h2>
      <div id="c2" class="accordion-collapse collapse" data-bs-parent="#acc-calc-menu">
        <div class="accordion-body">
          <p>Chceme jistotu, Å¾e mÃ¡me ÄÃ­sla. KdyÅ¾ ne, <code>ValueError</code> â†’ sluÅ¡nÄ› poÅ¾Ã¡dÃ¡me znovu.</p>
<pre><code class="language-python">def nacti_cisla():
    while True:
        try:
            a = float(input("Zadejte prvnÃ­ ÄÃ­slo: "))
            b = float(input("Zadejte druhÃ© ÄÃ­slo: "))
            return a, b
        except ValueError:
            print("MusÃ­te zadat ÄÃ­slo! Zkuste to znovu.")
            # while se opakuje</code></pre>
          <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalValueError">Co pÅ™esnÄ› je ValueError?</button>
            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#modalTryInLoop">Jak funguje try/except v cyklu?</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Krok 3: vÃ½bÄ›r operace â€“ dispatcher vracÃ­ funkci -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="c3h">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c3">
          3) VÃ½bÄ›r operace: funkce, kterÃ¡ vracÃ­ <em>funkci</em>
        </button>
      </h2>
      <div id="c3" class="accordion-collapse collapse" data-bs-parent="#acc-calc-menu">
        <div class="accordion-body">
<pre><code class="language-python">def vyber_operaci():
    while True:
        op = input("Zadejte operÃ¡tor (+,-,*,/): ")
        if op == "+": return ("SouÄet", soucet)
        if op == "-": return ("RozdÃ­l", rozdil)
        if op == "*": return ("SouÄin", soucin)
        if op == "/": return ("PodÃ­l",  podil)
        print("NeznÃ¡mÃ½ operÃ¡tor, zkuste znovu.")</code></pre>
          <p>VracÃ­me dvojici: <code>(nÃ¡zev, funkce)</code> â€“ abychom hezky vypsali vÃ½sledek.</p>
          <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalVraciFunkci">Jak mÅ¯Å¾e funkce vracet funkci?</button>
        </div>
      </div>
    </div>

    <!-- Krok 4: kalkulaÄka jako jedna volatelnÃ¡ funkce -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="c4h">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c4">
          4) SloÅ¾Ã­me kalkulaÄku do jednÃ© funkce: <code>spust_kalkulacku()</code>
        </button>
      </h2>
      <div id="c4" class="accordion-collapse collapse" data-bs-parent="#acc-calc-menu">
        <div class="accordion-body">
<pre><code class="language-python">def spust_kalkulacku():
    print("\n=== KALKULAÄŒKA ===")
    a, b = nacti_cisla()                 # 1) naÄti ÄÃ­sla
    nazev, funkce = vyber_operaci()      # 2) vyber operaci (nÃ¡zev + funkce)
    vysledek = funkce(a, b)              # 3) spoÄÃ­tej
    # 4) prezentace vÃ½sledku (f-string)
    if isinstance(vysledek, str):
        print(vysledek)                   # napÅ™. "DÄ›lit nulou nejde."
    else:
        print(f"{nazev}: {vysledek}")</code></pre>
          <div class="tip">KalkulaÄka teÄ Å¾ije v jedinÃ© funkci. **Menu** ji jen volÃ¡, a to kolikrÃ¡t chceÅ¡.</div>
        </div>
      </div>
    </div>

    <!-- Krok 5: menu ve smyÄce while + sys.exit -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="c5h">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c5">
          5) HlavnÃ­ menu: smyÄka, volÃ¡nÃ­ kalkulaÄky, korektnÃ­ ukonÄenÃ­
        </button>
      </h2>
      <div id="c5" class="accordion-collapse collapse" data-bs-parent="#acc-calc-menu">
        <div class="accordion-body">
<pre><code class="language-python">import sys

def vypis_menu():
    print("\n========== MENU ==========")
    print("1) KalkulaÄka")
    print("2) NÃ¡povÄ›da")
    print("3) Exit")

def main():
    while True:
        vypis_menu()
        volba = input("Zadejte volbu: ")
        if volba == "1":
            spust_kalkulacku()
            input("PokraÄuj klÃ¡vesou ENTER...")
        elif volba == "2":
            print("NÃ¡povÄ›da: zadejte dvÄ› ÄÃ­sla a vyberte operÃ¡tor (+,-,*,/).")
            input("ENTER...")
        elif volba == "3":
            sys.exit("Program ukonÄen.")       # korektnÃ­ konec
        else:
            print("NeplatnÃ¡ volba, zkuste znovu.")</code></pre>
          <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalSys">Co dÄ›lÃ¡ sys.exit()?</button>
            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#modalWhileVsFlag">while True vs. flag promÄ›nnÃ¡</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Krok 6: hygiena kÃ³du â€“ komentÃ¡Å™e, odsazenÃ­, VS Code -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="c6h">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c6">
          6) NeztraÅ¥ se: komentÃ¡Å™e, odsazenÃ­ a VS Code triky
        </button>
      </h2>
      <div id="c6" class="accordion-collapse collapse" data-bs-parent="#acc-calc-menu">
        <div class="accordion-body">
<pre><code class="language-python"># ====== MENU APLIKACE ======
# krÃ¡tkÃ©, vÃ½raznÃ© zÃ¡hlavÃ­ blokÅ¯ pomÅ¯Å¾e v orientaci
def vypis_menu():
    # --- VÃ½pis moÅ¾nostÃ­ ---
    print("...")

def spust_kalkulacku():
    # --- Vstupy ---
    # --- Volba operace ---
    # --- VÃ½poÄet a vÃ½stup ---
    pass</code></pre>
          <ul class="mb-2">
            <li><b>Odsadit blok</b>: oznaÄ Å™Ã¡dky â†’ <span class="kbd">Tab</span> (od-odsadit <span class="kbd">Shift</span>+<span class="kbd">Tab</span>).</li>
            <li><b>AutoformÃ¡t</b>: <span class="kbd">Shift</span>+<span class="kbd">Alt</span>+<span class="kbd">F</span> (Win/Linux), <span class="kbd">Option</span>+<span class="kbd">Shift</span>+<span class="kbd">F</span> (macOS).</li>
            <li><b>RychlÃ© komentovÃ¡nÃ­</b>: <span class="kbd">Ctrl</span>/<span class="kbd">Cmd</span> + <span class="kbd">/</span>.</li>
            <li><b>Sbalit/rozbalit bloky</b> podle odsazenÃ­ (gutter trojÃºhelnÃ­Äky).</li>
          </ul>
          <div class="ok">KrÃ¡tkÃ© funkce + jasnÃ© komentÃ¡Å™e = vnoÅ™enÃ© smyÄky jsou pÅ™ehlednÃ©.</div>
        </div>
      </div>
    </div>

  </div>

  <!-- FinÃ¡lnÃ­ blok: hotovÃ½ kÃ³d k odevzdÃ¡nÃ­ -->
  <div class="container my-4 p-4 border rounded bg-light">
    <h4 class="mb-3">ğŸ¯ FinÃ¡lnÃ­ verze k odevzdÃ¡nÃ­: menu â†’ ve smyÄce volÃ¡ kalkulaÄku</h4>
<pre><code class="language-python">import sys

def soucet(a, b):  return a + b
def rozdil(a, b):  return a - b
def soucin(a, b):  return a * b
def podil(a, b):
    if b == 0:
        return "DÄ›lit nulou nejde."
    return a / b

def nacti_cisla():
    while True:
        try:
            a = float(input("Zadejte prvnÃ­ ÄÃ­slo: "))
            b = float(input("Zadejte druhÃ© ÄÃ­slo: "))
            return a, b
        except ValueError:
            print("MusÃ­te zadat ÄÃ­slo! Zkuste to znovu.")

def vyber_operaci():
    while True:
        op = input("Zadejte operÃ¡tor (+,-,*,/): ")
        if op == "+": return ("SouÄet", soucet)
        if op == "-": return ("RozdÃ­l", rozdil)
        if op == "*": return ("SouÄin", soucin)
        if op == "/": return ("PodÃ­l",  podil)
        print("NeznÃ¡mÃ½ operÃ¡tor, zkuste znovu.")

def spust_kalkulacku():
    print("\n=== KALKULAÄŒKA ===")
    a, b = nacti_cisla()
    nazev, funkce = vyber_operaci()
    vysledek = funkce(a, b)
    if isinstance(vysledek, str):
        print(vysledek)
    else:
        print(f"{nazev}: {vysledek}")

def vypis_menu():
    print("\n========== MENU ==========")
    print("1) KalkulaÄka")
    print("2) NÃ¡povÄ›da")
    print("3) Exit")

def main():
    while True:
        vypis_menu()
        volba = input("Zadejte volbu: ")
        if volba == "1":
            spust_kalkulacku()
            input("PokraÄuj klÃ¡vesou ENTER...")
        elif volba == "2":
            print("NÃ¡povÄ›da: zadejte dvÄ› ÄÃ­sla a vyberte operÃ¡tor (+,-,*,/).")
            input("ENTER...")
        elif volba == "3":
            sys.exit("Program ukonÄen.")
        else:
            print("NeplatnÃ¡ volba, zkuste znovu.")

if __name__ == "__main__":
    main()</code></pre>
  </div>
</section>

<!-- ====== RecyklovanÃ© modÃ¡ly z dÅ™Ã­vÄ›jÅ¡ka (kvÅ¯li sobÄ›staÄnosti kapitoly) ====== -->
<div class="modal fade" id="modalReturnVsPrint" tabindex="-1" aria-labelledby="modalReturnVsPrintLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content">
    <div class="modal-header"><h5 id="modalReturnVsPrintLabel" class="modal-title">ProÄ radÄ›ji <code>return</code> neÅ¾ <code>print()</code>?</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button></div>
    <div class="modal-body">
<pre><code class="language-python">def f(a, b):      # nÃ¡vrat = data dÃ¡l, testovatelnost
    return a + b

def g(a, b):      # print = jen vÃ½stup do konzole
    print(a + b)</code></pre>
      <p>S <code>return</code> mÅ¯Å¾eÅ¡ vÃ½sledek znovu pouÅ¾Ã­t, uloÅ¾it Äi testovat.</p>
    </div>
  </div></div>
</div>

<div class="modal fade" id="modalFstring" tabindex="-1" aria-labelledby="modalFstringLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content">
    <div class="modal-header"><h5 id="modalFstringLabel" class="modal-title">f-string struÄnÄ›</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button></div>
    <div class="modal-body">
<pre><code class="language-python">a, b = 2, 3
print(f"SouÄet: {a + b}")  # â†’ SouÄet: 5</code></pre>
    </div>
  </div></div>
</div>

<div class="modal fade" id="modalValueError" tabindex="-1" aria-labelledby="modalValueErrorLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content">
    <div class="modal-header"><h5 id="modalValueErrorLabel" class="modal-title">Co je ValueError?</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button></div>
    <div class="modal-body">
<pre><code class="language-python">float("123")   # OK
float("ahoj")  # ValueError: 'ahoj' nenÃ­ ÄÃ­slo</code></pre>
      <p>ChytÃ¡me ho pÅ™i pÅ™evodu vstupu na ÄÃ­slo.</p>
    </div>
  </div></div>
</div>

<div class="modal fade" id="modalTryInLoop" tabindex="-1" aria-labelledby="modalTryInLoopLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content">
    <div class="modal-header"><h5 id="modalTryInLoopLabel" class="modal-title">Jak funguje try/except v cyklu?</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button></div>
    <div class="modal-body">
<pre><code class="language-python">while True:
    try:
        x = float(input("ÄŒÃ­slo: "))
        break
    except ValueError:
        print("Zkus to znovuâ€¦")</code></pre>
      <p>PÅ™i chybÄ› se cyklus zopakuje a znovu se zeptÃ¡.</p>
    </div>
  </div></div>
</div>

<div class="modal fade" id="modalSys" tabindex="-1" aria-labelledby="modalSysLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content">
    <div class="modal-header"><h5 id="modalSysLabel" class="modal-title">ProÄ <code>sys.exit()</code>?</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button></div>
    <div class="modal-body">
<pre><code class="language-python">import sys
sys.exit(0)              # 0 = OK, nenulovÃ© = chyba
# nebo:
sys.exit("Program ukonÄen.")</code></pre>
      <p>JasnÃ©, ÄitelnÃ© a â€profesionÃ¡lnÃ­â€œ ukonÄenÃ­ programu.</p>
    </div>
  </div></div>
</div>

<div class="modal fade" id="modalWhileVsFlag" tabindex="-1" aria-labelledby="modalWhileVsFlagLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content">
    <div class="modal-header"><h5 id="modalWhileVsFlagLabel" class="modal-title"><code>while True</code> vs. â€flagâ€œ promÄ›nnÃ¡</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button></div>
    <div class="modal-body">
      <ul>
        <li><b>while True</b> + <code>break/sys.exit</code> â†’ struÄnÃ©.</li>
        <li><b>flag promÄ›nnÃ¡</b> (<code>running = True</code>) â†’ ÄitelnÃ½ dÅ¯vod bÄ›hu/ukonÄenÃ­.</li>
      </ul>
      <p>V tÃ©hle lekci pouÅ¾Ã­vÃ¡me <code>while True</code> v <code>main()</code> kvÅ¯li jednoduchosti a <code>sys.exit()</code> pro korektnÃ­ ukonÄenÃ­.</p>
    </div>
  </div></div>
</div>